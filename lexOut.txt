2 1 program
25 1 a
32 1 ;
3 2 const
25 3 maxn
47 3 =
27 3 200005
32 3 ;
4 4 var
25 5 cntl
31 5 ,
25 5 cntr
33 5 :
5 5 array
37 5 [
27 5 0
34 5 .
34 5 .
27 5 200005
38 5 ]
6 5 of
7 5 integer
32 5 ;
25 6 t
31 6 ,
25 6 n
31 6 ,
25 6 l
31 6 ,
25 6 r
31 6 ,
25 6 c
33 6 :
7 6 integer
32 6 ;
25 7 o
31 7 ,
25 7 i
33 7 :
7 7 integer
32 7 ;
25 8 zd
31 8 ,
25 8 zs
31 8 ,
25 8 yd
31 8 ,
25 8 ys
33 8 :
7 8 integer
32 8 ;
25 9 ans
33 9 :
7 9 integer
32 9 ;
11 10 procedure
25 10 swap
35 10 (
4 10 var
25 10 a
31 10 ,
25 10 b
33 10 :
7 10 integer
36 10 )
32 10 ;
4 11 var
25 12 t
33 12 :
7 12 integer
32 12 ;
13 13 begin
25 14 t
28 14 :=
25 14 a
32 14 ;
25 15 a
28 15 :=
25 15 b
32 15 ;
25 16 b
28 16 :=
25 16 t
32 16 ;
14 17 end
32 17 ;
12 18 function
25 18 min
35 18 (
25 18 r
31 18 ,
25 18 c
33 18 :
7 18 integer
36 18 )
33 18 :
7 18 integer
32 18 ;
13 19 begin
15 20 if
25 20 r
49 20 <
25 20 c
16 20 then
25 21 min
28 21 :=
25 21 r
22 22 else
25 22 min
28 22 :=
25 22 c
32 22 ;
14 23 end
32 23 ;
13 24 begin
20 26 read
35 26 (
25 26 t
36 26 )
32 26 ;
17 27 for
25 27 o
28 27 :=
27 27 1
18 27 to
25 27 t
19 27 do
13 27 begin
20 28 read
35 28 (
25 28 n
31 28 ,
25 28 l
31 28 ,
25 28 r
36 28 )
32 28 ;
17 29 for
25 29 i
28 29 :=
27 29 1
18 29 to
25 29 n
19 29 do
13 29 begin
25 30 cntl
37 30 [
25 30 i
38 30 ]
28 30 :=
27 30 0
32 30 ;
25 31 cntr
37 31 [
25 31 i
38 31 ]
28 31 :=
27 31 0
32 31 ;
14 32 end
32 32 ;
17 33 for
25 33 i
28 33 :=
27 33 1
18 33 to
25 33 l
19 33 do
13 33 begin
20 34 read
35 34 (
25 34 c
36 34 )
32 34 ;
25 35 cntl
37 35 [
25 35 c
38 35 ]
28 35 :=
25 35 cntl
37 35 [
25 35 c
38 35 ]
45 35 +
27 35 1
32 35 ;
14 36 end
32 36 ;
17 37 for
25 37 i
28 37 :=
27 37 1
18 37 to
25 37 r
19 37 do
13 37 begin
20 38 read
35 38 (
25 38 c
36 38 )
32 38 ;
25 39 cntr
37 39 [
25 39 c
38 39 ]
28 39 :=
25 39 cntr
37 39 [
25 39 c
38 39 ]
45 39 +
27 39 1
32 39 ;
14 40 end
32 40 ;
17 41 for
25 41 i
28 41 :=
27 41 1
18 41 to
25 41 n
19 41 do
13 41 begin
25 42 c
28 42 :=
25 42 min
35 42 (
25 42 cntl
37 42 [
25 42 i
38 42 ]
31 42 ,
25 42 cntr
37 42 [
25 42 i
38 42 ]
36 42 )
32 42 ;
25 43 cntl
37 43 [
25 43 i
38 43 ]
28 43 :=
25 43 cntl
37 43 [
25 43 i
38 43 ]
46 43 -
25 43 c
32 43 ;
25 44 cntr
37 44 [
25 44 i
38 44 ]
28 44 :=
25 44 cntr
37 44 [
25 44 i
38 44 ]
46 44 -
25 44 c
32 44 ;
14 45 end
32 45 ;
25 46 zd
28 46 :=
27 46 0
32 46 ;
25 47 zs
28 47 :=
27 47 0
32 47 ;
25 48 yd
28 48 :=
27 48 0
32 48 ;
25 49 ys
28 49 :=
27 49 0
32 49 ;
17 50 for
25 50 i
28 50 :=
27 50 1
18 50 to
25 50 n
19 50 do
13 50 begin
25 51 zd
28 51 :=
25 51 zd
45 51 +
25 51 cntl
37 51 [
25 51 i
38 51 ]
41 51 mod
27 51 2
32 51 ;
25 52 zs
28 52 :=
25 52 zs
45 52 +
25 52 cntl
37 52 [
25 52 i
38 52 ]
40 52 div
27 52 2
32 52 ;
14 53 end
32 53 ;
17 54 for
25 54 i
28 54 :=
27 54 1
18 54 to
25 54 n
19 54 do
13 54 begin
25 55 yd
28 55 :=
25 55 yd
45 55 +
25 55 cntr
37 55 [
25 55 i
38 55 ]
41 55 mod
27 55 2
32 55 ;
25 56 ys
28 56 :=
25 56 ys
45 56 +
25 56 cntr
37 56 [
25 56 i
38 56 ]
40 56 div
27 56 2
32 56 ;
14 57 end
32 57 ;
25 59 ans
28 59 :=
27 59 0
32 59 ;
15 60 if
25 60 zd
49 60 <
25 60 yd
16 60 then
13 60 begin
25 61 swap
35 61 (
25 61 zd
31 61 ,
25 61 yd
36 61 )
32 61 ;
25 62 swap
35 62 (
25 62 zs
31 62 ,
25 62 ys
36 62 )
32 62 ;
14 63 end
32 63 ;
25 64 zd
28 64 :=
25 64 zd
46 64 -
25 64 yd
32 64 ;
25 65 ans
28 65 :=
25 65 ans
45 65 +
25 65 yd
45 65 +
25 65 zs
32 65 ;
25 66 yd
28 66 :=
27 66 0
32 66 ;
25 67 zs
28 67 :=
27 67 0
32 67 ;
15 68 if
25 68 ys
42 68 *
27 68 2
52 68 >=
25 68 zd
16 68 then
13 68 begin
25 69 ans
28 69 :=
25 69 ans
45 69 +
25 69 zd
45 69 +
35 69 (
25 69 ys
42 69 *
27 69 2
46 69 -
25 69 zd
36 69 )
40 69 div
27 69 2
32 69 ;
14 70 end
22 71 else
13 71 begin
25 72 ans
28 72 :=
25 72 ans
45 72 +
25 72 ys
42 72 *
27 72 2
32 72 ;
25 73 zd
28 73 :=
25 73 zd
46 73 -
25 73 ys
42 73 *
27 73 2
32 73 ;
25 74 ans
28 74 :=
25 74 ans
45 74 +
25 74 zd
32 74 ;
14 75 end
32 75 ;
21 76 write
35 76 (
25 76 ans
36 76 )
32 76 ;
14 77 end
32 77 ;
14 79 end
34 79 .
