2 1 program
25 1 a
32 1 ;
3 2 const
25 3 maxn
47 3 =
27 3 200005
32 3 ;
4 4 var
25 5 cntl
31 5 ,
25 5 cntr
33 5 :
5 5 array
37 5 [
27 5 0
34 5 .
34 5 .
27 5 200005
38 5 ]
6 5 of
7 5 integer
32 5 ;
25 6 t
31 6 ,
25 6 n
31 6 ,
25 6 l
31 6 ,
25 6 r
31 6 ,
25 6 c
33 6 :
7 6 integer
32 6 ;
25 7 o
31 7 ,
25 7 i
33 7 :
7 7 integer
32 7 ;
25 8 zd
31 8 ,
25 8 zs
31 8 ,
25 8 yd
31 8 ,
25 8 ys
33 8 :
7 8 integer
32 8 ;
25 9 ans
33 9 :
7 9 integer
32 9 ;
11 10 procedure
25 10 swap
35 10 (
4 10 var
25 10 a
31 10 ,
25 10 b
33 10 :
7 10 integer
36 10 )
32 10 ;
4 11 var
25 12 t
33 12 :
7 12 integer
32 12 ;
13 13 begin
25 14 t
28 14 :=
25 14 a
32 14 ;
25 15 a
28 15 :=
25 15 b
32 15 ;
25 16 b
28 16 :=
25 16 t
32 16 ;
14 17 end
32 17 ;
12 18 function
25 18 min
35 18 (
25 18 r
31 18 ,
25 18 c
33 18 :
7 18 integer
36 18 )
33 18 :
7 18 integer
32 18 ;
13 19 begin
15 20 if
25 20 r
49 20 <
25 20 c
16 20 then
25 21 min
28 21 :=
25 21 r
22 22 else
25 22 min
28 22 :=
25 22 c
32 22 ;
14 23 end
32 23 ;
13 24 begin
20 25 read
35 25 (
25 25 t
36 25 )
32 25 ;
17 26 for
25 26 o
28 26 :=
27 26 1
18 26 to
25 26 t
19 26 do
13 26 begin
20 27 read
35 27 (
25 27 n
31 27 ,
25 27 l
31 27 ,
25 27 r
36 27 )
32 27 ;
17 28 for
25 28 i
28 28 :=
27 28 1
18 28 to
25 28 n
19 28 do
13 28 begin
25 29 cntl
37 29 [
25 29 i
38 29 ]
28 29 :=
27 29 0
32 29 ;
25 30 cntr
37 30 [
25 30 i
38 30 ]
28 30 :=
27 30 0
32 30 ;
14 31 end
32 31 ;
17 32 for
25 32 i
28 32 :=
27 32 1
18 32 to
25 32 l
19 32 do
13 32 begin
20 33 read
35 33 (
25 33 c
36 33 )
32 33 ;
25 34 cntl
37 34 [
25 34 c
38 34 ]
28 34 :=
25 34 cntl
37 34 [
25 34 c
38 34 ]
45 34 +
27 34 1
32 34 ;
14 35 end
32 35 ;
17 36 for
25 36 i
28 36 :=
27 36 1
18 36 to
25 36 r
19 36 do
13 36 begin
20 37 read
35 37 (
25 37 c
36 37 )
32 37 ;
25 38 cntr
37 38 [
25 38 c
38 38 ]
28 38 :=
25 38 cntr
37 38 [
25 38 c
38 38 ]
45 38 +
27 38 1
32 38 ;
14 39 end
32 39 ;
17 40 for
25 40 i
28 40 :=
27 40 1
18 40 to
25 40 n
19 40 do
13 40 begin
25 41 c
28 41 :=
25 41 min
35 41 (
25 41 cntl
37 41 [
25 41 i
38 41 ]
31 41 ,
25 41 cntr
37 41 [
25 41 i
38 41 ]
36 41 )
32 41 ;
25 42 cntl
37 42 [
25 42 i
38 42 ]
28 42 :=
25 42 cntl
37 42 [
25 42 i
38 42 ]
46 42 -
25 42 c
32 42 ;
25 43 cntr
37 43 [
25 43 i
38 43 ]
28 43 :=
25 43 cntr
37 43 [
25 43 i
38 43 ]
46 43 -
25 43 c
32 43 ;
14 44 end
32 44 ;
25 45 zd
28 45 :=
27 45 0
32 45 ;
25 46 zs
28 46 :=
27 46 0
32 46 ;
25 47 yd
28 47 :=
27 47 0
32 47 ;
25 48 ys
28 48 :=
27 48 0
32 48 ;
17 49 for
25 49 i
28 49 :=
27 49 1
18 49 to
25 49 n
19 49 do
13 49 begin
25 50 zd
28 50 :=
25 50 zd
45 50 +
25 50 cntl
37 50 [
25 50 i
38 50 ]
41 50 mod
27 50 2
32 50 ;
25 51 zs
28 51 :=
25 51 zs
45 51 +
25 51 cntl
37 51 [
25 51 i
38 51 ]
40 51 div
27 51 2
32 51 ;
14 52 end
32 52 ;
17 53 for
25 53 i
28 53 :=
27 53 1
18 53 to
25 53 n
19 53 do
13 53 begin
25 54 yd
28 54 :=
25 54 yd
45 54 +
25 54 cntr
37 54 [
25 54 i
38 54 ]
41 54 mod
27 54 2
32 54 ;
25 55 ys
28 55 :=
25 55 ys
45 55 +
25 55 cntr
37 55 [
25 55 i
38 55 ]
40 55 div
27 55 2
32 55 ;
14 56 end
32 56 ;
25 58 ans
28 58 :=
27 58 0
32 58 ;
15 59 if
25 59 zd
49 59 <
25 59 yd
16 59 then
13 59 begin
25 60 swap
35 60 (
25 60 zd
31 60 ,
25 60 yd
36 60 )
32 60 ;
25 61 swap
35 61 (
25 61 zs
31 61 ,
25 61 ys
36 61 )
32 61 ;
14 62 end
32 62 ;
25 63 zd
28 63 :=
25 63 zd
46 63 -
25 63 yd
32 63 ;
25 64 ans
28 64 :=
25 64 ans
45 64 +
25 64 yd
45 64 +
25 64 zs
32 64 ;
25 65 yd
28 65 :=
27 65 0
32 65 ;
25 66 zs
28 66 :=
27 66 0
32 66 ;
15 67 if
25 67 ys
42 67 *
27 67 2
52 67 >=
25 67 zd
16 67 then
13 67 begin
25 68 ans
28 68 :=
25 68 ans
45 68 +
25 68 zd
45 68 +
35 68 (
25 68 ys
42 68 *
27 68 2
46 68 -
25 68 zd
36 68 )
40 68 div
27 68 2
32 68 ;
14 69 end
22 70 else
13 70 begin
25 71 ans
28 71 :=
25 71 ans
45 71 +
25 71 ys
42 71 *
27 71 2
32 71 ;
25 72 zd
28 72 :=
25 72 zd
46 72 -
25 72 ys
42 72 *
27 72 2
32 72 ;
25 73 ans
28 73 :=
25 73 ans
45 73 +
25 73 zd
32 73 ;
14 74 end
32 74 ;
21 75 write
35 75 (
25 75 ans
36 75 )
32 75 ;
14 76 end
32 76 ;
14 78 end
34 78 .
